if (panel==7) {
par(new=TRUE)
symbols(rep(75,3), c(120,170,220),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-3, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(75,3), c(120,170,220),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
text
?text
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(120,170,220),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(75,3), y=c(120,170,220), labels=c("50", "150", "250"), pos=c(4,4,4,4))
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(120,170,220),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(120,170,220), labels=c("50", "150", "250"), pos=c(4,4,4,4))
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(120,170,220),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(120,170,220), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=65, y=250, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(120,170,220),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(120,170,220), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=65, y=260, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(110,160,210),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(120,170,220), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=65, y=247, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(115,155,195),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(115,155,195), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=66, y=247, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
pdf("stot_bubbles.pdf", width=6, height=6)
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
pdf("ptot_bubbles.pdf", width=6, height=6)
bubble("ptot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(110,170,230),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(110,170,230), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=66, y=247, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
pdf("stot_bubbles.pdf", width=6, height=6)
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
pdf("ptot_bubbles.pdf", width=6, height=6)
bubble("ptot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(110,160,240),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(110,160,240), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=40, y=200, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
pdf("ptot_bubbles.pdf", width=6, height=6)
bubble("ptot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(110,160,230),
circles=sqrt(c(50,150,250)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(110,160,230), labels=c("50", "150", "250"), pos=c(4,4,4,4))
text(x=40, y=200, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
pdf("stot_bubbles.pdf", width=6, height=6)
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
pdf("ptot_bubbles.pdf", width=6, height=6)
bubble("ptot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(110,160,230),
circles=sqrt(c(10,50,150)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(68,3), y=c(110,160,230), labels=c("10", "50", "150"), pos=c(4,4,4,4))
text(x=40, y=200, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
pdf("stot_bubbles.pdf", width=6, height=6)
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
pdf("ptot_bubbles.pdf", width=6, height=6)
bubble("ptot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
bubble <- function(target, scale=0.25, fg="red", bg="red", cex.lab=1.5, cex.axis=2, cex.title=0.5, line.xaxis=1, las=0) {
#The "_nosnow" dataframes exclude the snowfall-influenced events.
num_rows = ceiling(length(streams)/2)
layout(matrix(1:(2*num_rows), num_rows, 2))
par(mar=c(1,0,0,1), oma=c(4.5,4.5,0,1), ann=FALSE)
yy=c(0, 50*ceiling(max(aggregate$theisen*1.1, na.rm=TRUE)/50))
panel=1
for(stream_name in streams) {
#Retrieve the data frame for this stream
stream = get(stream_name)
#Produce the bubble plots
symbols(100*stream[stream$snow==FALSE,]$antecedent_qbase_quantile,
stream[stream$snow==FALSE,]$theisen,
circles=sqrt(stream[stream$snow==FALSE,target]),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
#Prepare a bubble-size legend:
if (panel==7) {
par(new=TRUE)
symbols(rep(65,3), c(110,160,230),
circles=sqrt(c(10,50,150)),
inches=scale, fg=fg, bg=bg, bty='n',
xlim=c(0, 100), #max(stream$antecedent_qbase_quantile, na.rm=TRUE)*1.1),
ylim=yy, #c(0, max(stream$theisen, na.rm=TRUE)*1.2),
xaxt='n', yaxt='n')
text(x=rep(69,3), y=c(110,160,230), labels=c("10", "50", "150"), pos=c(4,4,4,4))
text(x=40, y=200, labels="Legend:", adj=0.5)
}
if (panel %in% c(4,8)) {axis(side=1, cex.axis=cex.axis, las=las, mgp=c(3,line.xaxis,0))}
if (panel %in% 1:4) {axis(side=2, cex.axis=cex.axis, las=las, at=seq(yy[1], yy[2], by=50))}
mtext(stream_names[[stream_name]], side=3, line=-5, cex=cex.title, at=20)
panel=panel+1
}
mtext("Antecedent baseflow percentile", side=1, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
mtext("Rainfall depth (mm)", side=2, line=2.5, cex=cex.lab, at=NA, outer=TRUE)
}
pdf("stot_bubbles.pdf", width=6, height=6)
bubble("stot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
pdf("ptot_bubbles.pdf", width=6, height=6)
bubble("ptot_yield", scale=0.15, bg="grey65", fg="black", line.xaxis=1.2, cex.axis=1, cex.title=1, cex.lab=1)
dev.off()
